<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiberHoop - Interactive Quiz Game Platform</title>
    <meta name="description" content="Kahoot + Jackbox for library quizzes. A free, open-source, real-time interactive quiz game platform for libraries, schools, and community events.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="launch.css">
</head>
<body>
    <!-- Error Notification -->
    <div id="errorNotification" class="error-notification hidden">
        <span class="error-icon">‚ö†Ô∏è</span>
        <div>
            <div class="error-message" id="errorMessage">Service temporarily unavailable or down for maintenance</div>
            <div class="error-details" id="errorDetails"></div>
        </div>
        <button class="close-btn" onclick="hideError()">√ó</button>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="logo-large">üìö</div>
            <h1>LiberHoop</h1>
            <p class="tagline">Kahoot + Jackbox for Library Quizzes</p>
            <p class="description">
                A real-time, interactive quiz game platform designed for library events, teen programs, and educational gatherings. 
                Free, open source, and privacy-focused.
            </p>
            <div class="cta-buttons">
                <a href="player.html" class="btn btn-primary">Join a Game</a>
                <a href="admin.html" class="btn btn-admin">Admin Login</a>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section id="how-it-works">
        <h2 class="section-title">How It Works</h2>
        <div class="how-it-works">
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>Host Creates a Room</h3>
                    <p>Admins log in and create a game session with a unique room code. Choose game modes, question categories, and settings.</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>Players Join</h3>
                    <p>Players visit the site on their mobile devices or browsers, enter the room code, and join the game instantly. No accounts needed!</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>Play & Compete</h3>
                    <p>Answer questions in real-time, compete for points, and see live leaderboards. Play minigames while waiting between rounds.</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h3>Celebrate Winners</h3>
                    <p>View final scores and celebrate the winners! Perfect for engaging library events and educational gatherings.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Benefits Section -->
    <section id="benefits">
        <h2 class="section-title">Why LiberHoop?</h2>
        <div class="benefits">
            <div class="benefit-card">
                <div class="benefit-icon">üÜì</div>
                <h3>Completely Free</h3>
                <p>No subscriptions, no hidden fees, no student data tracking. LiberHoop is open source and free for educators and libraries.</p>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">üîí</div>
                <h3>Privacy-Focused</h3>
                <p>We don't collect or store student data. Players join with just a name - no accounts, no tracking, just fun gameplay.</p>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">‚ö°</div>
                <h3>Real-Time Action</h3>
                <p>WebSocket-powered real-time gameplay ensures instant updates, live leaderboards, and seamless multiplayer experience.</p>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">üéÆ</div>
                <h3>Multiple Game Modes</h3>
                <p>Classic quiz mode for fast-paced competition, or Bowl mode for strategic quiz bowl-style gameplay with buzzing and stealing.</p>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">üì±</div>
                <h3>Mobile-Friendly</h3>
                <p>Players use their own devices - phones, tablets, or laptops. No special apps needed, just a web browser.</p>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">üé®</div>
                <h3>Engaging Minigames</h3>
                <p>Keep players entertained with drawing games and microgames while waiting for the next question to start.</p>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features">
        <h2 class="section-title">Key Features</h2>
        <div class="features-grid">
            <div class="feature-item">
                <div class="feature-icon">üéØ</div>
                <div class="feature-content">
                    <h4>Multiple Question Types</h4>
                    <p>Multiple choice, true/false, text input, number input, polls, and wager questions for diverse gameplay.</p>
                </div>
            </div>
            <div class="feature-item">
                <div class="feature-icon">üë•</div>
                <div class="feature-content">
                    <h4>Team Support</h4>
                    <p>Optional team mode with drag-and-drop team assignment. Perfect for group activities and collaborative learning.</p>
                </div>
            </div>
            <div class="feature-item">
                <div class="feature-icon">üìä</div>
                <div class="feature-content">
                    <h4>Live Leaderboards</h4>
                    <p>Real-time score tracking and leaderboards keep the competition exciting and engaging throughout the game.</p>
                </div>
            </div>
            <div class="feature-item">
                <div class="feature-icon">‚öôÔ∏è</div>
                <div class="feature-content">
                    <h4>Easy Question Management</h4>
                    <p>Admin panel for creating, organizing, and managing questions by categories. Export and import for sharing.</p>
                </div>
            </div>
            <div class="feature-item">
                <div class="feature-icon">üåê</div>
                <div class="feature-content">
                    <h4>Flexible Deployment</h4>
                    <p>Run on local networks, Raspberry Pi, or with Cloudflare Tunnel for public access. No complex setup required.</p>
                </div>
            </div>
            <div class="feature-item">
                <div class="feature-icon">üîß</div>
                <div class="feature-content">
                    <h4>Open Source</h4>
                    <p>Built by the community, for the community. Contribute features, translations, or improvements to make it better.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Admin Section -->
    <section id="admin">
        <div class="admin-section">
            <h2>For Administrators</h2>
            <p>Manage questions, create game sessions, and host engaging quiz events for your library or organization.</p>
            <a href="admin.html" class="btn btn-admin">Admin Login</a>
        </div>
    </section>

    <!-- Donation Section -->
    <section id="donate">
        <div class="donation-section">
            <div class="donation-icon">‚òï</div>
            <h2>Enjoying LiberHoop?</h2>
            <p>If you find this project useful and would like to support its development, consider making a donation. Every contribution helps keep LiberHoop free and open source!</p>
            <p class="donation-note">Donations are completely optional - the game is and always will be free to use.</p>
            <div class="donation-buttons">
                <a href="https://ko-fi.com/concreterose" class="btn btn-donate" target="_blank" rel="noopener noreferrer">
                    ‚òï Buy me a coffee
                </a>
                <a href="https://cash.app/$datkod" class="btn btn-donate" target="_blank" rel="noopener noreferrer">
                    üíµ Donate via CashApp
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p><strong>LiberHoop</strong> - Free, Open Source, Privacy-Focused</p>
        <p>Designed for libraries, schools, and community events</p>
        <p>
            <a href="https://github.com" target="_blank" rel="noopener noreferrer">View on GitHub</a> | 
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">CC BY-NC-SA 4.0</a>
        </p>
    </footer>

    <script>
        // Server connectivity check
        let serverCheckInterval = null;
        let lastServerStatus = null;

        async function checkServerStatus() {
            try {
                // Try to fetch a simple endpoint or check WebSocket
                const response = await fetch('/api/ip', {
                    method: 'GET',
                    signal: AbortSignal.timeout(3000) // 3 second timeout
                });
                
                if (response.ok) {
                    if (lastServerStatus !== 'online') {
                        hideError();
                        lastServerStatus = 'online';
                    }
                    return true;
                } else {
                    showError('Service temporarily unavailable', 'Please try again later.');
                    lastServerStatus = 'error';
                    return false;
                }
            } catch (error) {
                if (error.name === 'AbortError' || error.name === 'TimeoutError') {
                    showError('Connection timeout', 'The service is taking too long to respond. Please check your internet connection and try again.');
                } else if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                    showError('Unable to connect', 'The game may be temporarily unavailable due to maintenance.');
                } else {
                    showError('Connection issue', 'Unable to connect right now. Please try again later.');
                }
                lastServerStatus = 'offline';
                return false;
            }
        }

        function showError(message, details = '') {
            const notification = document.getElementById('errorNotification');
            const messageEl = document.getElementById('errorMessage');
            const detailsEl = document.getElementById('errorDetails');
            
            messageEl.textContent = message;
            if (details) {
                detailsEl.textContent = details;
                detailsEl.style.display = 'block';
            } else {
                detailsEl.style.display = 'none';
            }
            
            notification.classList.remove('hidden');
            notification.classList.remove('warning', 'info');
            notification.classList.add('error');
        }

        function hideError() {
            const notification = document.getElementById('errorNotification');
            notification.classList.add('hidden');
        }

        // Check server status on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Initial check
            checkServerStatus();
            
            // Check every 30 seconds
            serverCheckInterval = setInterval(checkServerStatus, 30000);
            
            // Also check when user tries to navigate
            document.querySelectorAll('a[href]').forEach(link => {
                link.addEventListener('click', async (e) => {
                    // Only check for internal links
                    if (link.href.includes(window.location.hostname) || 
                        link.getAttribute('href').startsWith('/') ||
                        !link.getAttribute('href').startsWith('http')) {
                        const isOnline = await checkServerStatus();
                        if (!isOnline) {
                            e.preventDefault();
                            // Show error is already handled by checkServerStatus
                        }
                    }
                });
            });
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (serverCheckInterval) {
                clearInterval(serverCheckInterval);
            }
        });
    </script>
</body>
</html>
